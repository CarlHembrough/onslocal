<!DOCTYPE html> 
<html> 
  <head> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no"> 
    <title></title>
     <!-- Latest compiled and minified CSS to go in head -->
     <link href="resources/css/nessmain.css" rel="stylesheet" type="text/css">
     <link href="resources/css/showmore.css" rel="stylesheet" type="text/css">
     <link rel="stylesheet" href="http://js.arcgis.com/3.14/esri/css/esri.css"> 
     <link rel="stylesheet" href="http://js.arcgis.com/3.14/dijit/themes/claro/claro.css">
     <link rel="stylesheet" href="http://js.arcgis.com/3.14/dijit/themes/tundra/tundra.css">   
     <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"> </script>
     <!-- Latest minified and concatenated JS to go in head -->
     <!-- Latest minified and concatenated JS to go in the footer -->
     <script src="resources/javascript/footer.js"></script>  
     <script src="resources/javascript/header.js"></script>      
     <script src="resources/javascript/map.js"></script> 
     <script src="resources/javascript/highlightMap.js"></script>  
     <script src="resources/javascript/hoverMap.js"></script>
     <script src="resources/javascript/charts.js"></script>
     <script src="resources/javascript/createTable.js"></script>
     <script src="resources/javascript/ukMap.js"></script>    
     <script src="resources/javascript/download.js"></script>    
     <script src="resources/javascript/getDataTable.js"></script>    
     <script defer src="http://js.arcgis.com/3.14/"></script> 
    
       
     <style>  
       html, body { height: 100%; width: 100%; margin: 0; padding: 0; } 
       #map{padding:0;} 
	   #innerDIV{position:absolute;z-index: 1; top:375px; left:25px; width:300px;} 
	   #outerDIV{position:relative;} 
	   #HomeButton {position: absolute;top: 250px;left: 14px;z-index: 50;}		   
     </style>
    
   
     <script>     
	    // Read a user input postcode and strip of plus signs,
	    // convert to uppercase and reformat if necessary
	    
	    //declare global var and set to home tab
	    var current_tab = "tab1";
	    
	    function  postcode_reformat(postcode) {
	       // strip + sign from postcode string & convert to uppercase
    	   postcode                     = postcode.replace(/\+/g, '');
    	   var upperCasePostCode        = postcode.toUpperCase();    	
    	   var regPostcode              = /^([a-zA-Z]){1}([0-9][0-9]|[0-9]|[a-zA-Z][0-9][a-zA-Z]|[a-zA-Z][0-9][0-9]|[a-zA-Z][0-9]){1}([ ])([0-9][a-zA-z][a-zA-z]){1}$/;
		 
	       if(regPostcode.test(upperCasePostCode) == false)	
	       {	
	    	   var re                   = /^([A-Z]{1,2}[\dA-Z]{1,2})[ ]?(\d[A-Z]{2})$/i; // case insensitive 	
	    	   var tempPostCode         = upperCasePostCode.match(re);
	    	   var reformatPostcode     = tempPostCode[1] + " " + tempPostCode[2];
	    	   return reformatPostcode;
	       }
	       else {
	    	 // postcode formatted correctly
	    	 return upperCasePostCode;
		   }	    	
		}
	    
	    // Read a page's GET URL variables and return them as an associative array.
	    function getUrlVars() {	    
	        var vars = [], hash;
	        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
	        //hashes = decodeURI(window.location.href).replace(/[?&]+([^=&]+)=([^&]*)/gi;
	        for(var i = 0; i < hashes.length; i++)
	        {
	            hash = hashes[i].split('=');
	            vars.push(hash[0]);
	            vars[hash[0]] = hash[1];
	        }
	        return vars;
	    }    
	  
	    function getUrlParams() {
	        var vars = {};
	        parts = decodeURI(window.location.href).replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
	        vars[key] = value;
	        });
	        return vars;
	    }	    
	    
	    // get parameters from url	    
	    var levelname, childname;
	    var postcode;	  
	   
	    postcode =  getUrlParams()["nav-search"];	    
	    levelname = getUrlParams()["levelname"];	    
	    childname = getUrlParams()["childname"];
	    
		var pCode;
		if (postcode == null || postcode.length == 0 || typeof postcode === 'undefined') {
		  jsonFile      ='uk.json';	
	    } 
		else {
	      // identify json file	
		  pCode         = postcode.replace(/\+/g, '');
		  pCode         = pCode.replace(/\s/g, '');
		  jsonFile      = pCode.toLowerCase() + '.json';
		  
		  postcode = postcode_reformat(postcode);
	    }	  
		  
		$(document).ready(function(){
		  $.getJSON(jsonFile, function(result){
	         createMap(result, postcode,levelname,childname);
		  }); 
		}); 
		
	  </script>	  
	 
	  <script type="text/javascript">
	   function tab(tab) {
	     document.getElementById('tab1').style.display = 'none';
	     document.getElementById('tab2').style.display = 'none';
	     document.getElementById('tab3').style.display = 'none';
	     document.getElementById('li_tab1').setAttribute("class", "");
	     document.getElementById('li_tab2').setAttribute("class", "");
	     document.getElementById('li_tab3').setAttribute("class", "");
	     document.getElementById(tab).style.display = 'block';	    
	     document.getElementById('li_'+ tab).setAttribute("class", "current");
	     current_tab = tab;
	  //   testerFunction();
	  
	  //   function testerFunction(tab) {
	  //  	 alert("reste");
	  //  	    changeColumnColor('current','white');
	  //  	}
	  //  	function changeColumnColor(column,color) {
	   // 	    var cols = document.getElementsByClassName(column);
	    //	    alert("cols" + cols.toSource());
	    	//    for(i=0; i<cols.length; i++) {
	    	//      cols[i].style.backgroundColor = color;
	    	 //   }		    	    
	    	//}
	   }
	  </script>
	  
	  <!-- SHOW MORE JS -->
	  <script type='text/javascript'>//<![CDATA[
		$(window).load(function(){
		var $text = $('.text'),
		    i = 0;
		
		$(".show-more").on('click', function() {
			var originalValueText = $("#detail-text").text();
			$("#detail-text").text(originalValueText == "More Detail" ? "Less Detail" : "More Detail" );
		    $("#tables").toggle();
		});
		
		});//]]> 
		
		</script>
	  
  </head> 
  <body class="tundra"> 
    <form id="mapForm" name="mapForm">
      <input type="hidden" name="queryExtent" value=""/>
    </form>      
      <div class="wrapper panel--mar nav-panels">
	        <div class="grid-wrap">
	            <header>
	              <div class="global-header__wrapper">        
	                   <a href="#"><img src="resources/images/ons-logo.png" alt="Insert Logo Here" width="264" height="50" id="Insert_logo" style="display: block;" /></a>       
	              </div>
	            </header>
	        
	            <div id="outerDIV" class="slate--grey search-wrapper">
		              <div><a href="index.html"><img src="resources/images/home_w.png" alt="" width="50" height="50" style="position:absolute; margin-left:20px; margin-top:10px;"></a>
		              </div>  
		              <form class="nav-search nav-search--hidden" id="searchBar">         
			                <div class="nav-search__container">
			                  <label for="nav-search"></label>
			                  <input type="search" class="nav-search__field" id="nav-search" name="nav-search" value="" placeholder="Search postcode or place name in England and Wales">
			                </div>
			                <button type="submit" class="btn btn--primary btn--nav-search" id="nav-search-submit">
			                  <span class="icon-search-1" role="presentation"></span>
			                </button>
			                <script>  
			                  $('#nav-search').attr('placeholder',postcode);                   
			                </script> 
		               </form>
	            </div> 
	                        	             
	            <div id="map" style="height: 500px; margin-top:0px;">
	               <div id="HomeButton"></div>             
	            </div>	                        
	            <div id="selArea1"></div>	            	            
          </div>          
          
          <div id="Tabs" style="display: none;">
             <ul class="ul_tab">
			  	<li id="li_tab1" class="current" onclick="tab('tab1')"><a>Population</a></li>
				<li id="li_tab2" onclick="tab('tab2')"><a>Religion</a></li>
				<li id="li_tab3" onclick="tab('tab3')"><a>Economy</a></li>				
			 </ul>
			 <div id="Content_Area">
				<div id="tab1">				 
				   <div id="tableChart"  style="display: none;">
				      <article class="wrapper">
					    <div class="grid-wrap panel panel--separated--bottom">
					       <div class="grid-col desktop-grid-one-half">
						         <header>
						            <h2>Population</h2>
						        </header>
					            <dl class="grid-wrap flush--top flush--bottom panel panel--separated--bottom ">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Total</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="sapede-all">
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">Mar 2014</span>
					                    </div>
					                </dd>
					            </dl>
					            <dl class="grid-wrap flush--top flush--bottom panel panel--separated--bottom">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Males</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="sapede-males">
					                       
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">Mar 2014</span>
					                    </div>
					                </dd>
					            </dl>
					            <dl class="grid-wrap panel flush--top flush--bottom">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Females</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="sapede-females">
					                      
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">Mar 2014</span>
					                    </div>
					                </dd>
					            </dl>
					        </div>
					        <div class="grid-col desktop-grid-one-half" id="population-pyramid" data-chart="pyramid" style="width:450px"></div>
					    </div>
					  </article>          
	              </div>                 
			    </div>
			    <div id="tab2" style="display: none;"> 
				    <div id="religionChart"  style="display: none;">
				      <article class="wrapper">
					    <div class="grid-wrap panel panel--separated--bottom">
					       <div class="grid-col desktop-grid-one-half">
						         <header>
						            <h2>Religion</h2>
						        </header>
					            <dl class="grid-wrap flush--top flush--bottom panel panel--separated--bottom ">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Total</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="lc2107ew-all">
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">2011</span>
					                    </div>
					                </dd>
					            </dl>
					            <dl class="grid-wrap flush--top flush--bottom panel panel--separated--bottom">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Christian</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="lc2107ew-christian">
					                       
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">2011</span>
					                    </div>
					                </dd>
					            </dl>					            
					            <dl class="grid-wrap flush--top flush--bottom panel panel--separated--bottom ">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Muslim</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="lc2107ew-muslim">
					                      
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">2011</span>
					                    </div>
					                </dd>
					            </dl>
					            
					            <dl class="grid-wrap flush--top flush--bottom panel panel--separated--bottom ">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Buddhist</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="lc2107ew-buddhist">
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">2011</span>
					                    </div>
					                </dd>
					            </dl>
					            <dl class="grid-wrap flush--top flush--bottom panel panel--separated--bottom">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Sikh</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="lc2107ew-sikh">
					                       
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">2011</span>
					                    </div>
					                </dd>
					            </dl>
					            <dl class="grid-wrap panel flush--top flush--bottom">
					                <dt class="grid-col desktop-grid-one-half">
					                    <h3 class="stat__figure delta">
					                        <a href="#">Other</a>
					                    </h3>
					                </dt>
					                <dd class="grid-col desktop-grid-one-half flush">
					                    <div class="stat__figure delta" id="lc2107ew-other">
					                      
					                    </div>
					                    <div class="stat__figure delta">
					                        <span class="stat__description">2011</span>
					                    </div>
					                </dd>
					            </dl>
					        </div>
					        <div class="grid-col desktop-grid-one-half" id="religion-bar" data-chart="stacked-bar" style="width:450px"></div>
					    </div>
					  </article>
			    </div>			    
		    </div>
		    <div id="tab3" style="display: none;"> 
	         <header>
	           <h2>Economy data to follow</h2>    
	         </header>
	      </div>    
	     </div>
       </div>  
      		 
                <div id="additional-data" class="accordion is-collapsed show-more" style="display: none;">
                  <h2 id="detail-text" class="accordion__title delta" aria-controls="content-0">More Detail</h2>
                  <div id="content-3" class="accordion__content" aria-labelledby="sc-0">
                    
				</div>						
			</div>
			
			
			<div class="show-tables" id="tables" style="display: none;">
                    
                    	<!-- Table 1 -->
                    
                    <div>
                      <div id="myDiv" class="container2 zigzag">
                        <!-- script>getData('E00116582', levelname, 'popSexGeog');</script -->
						<div id="popSexGeog">
						<!-- contents created from getDataTable.js -->
						<br>
						
						
						</div>
						
						</div>	
							
						<div>
							<p class="tablesubtitle">Download full table</p>
							<p class="tablesubsubtitle">Download contents: population by sex; multiple geographies</p>
						</div>
						
						
						
						<div class="download_btn" onClick="download(current_tab, 'xlsx')">.XLSX (12KB) 
							<span class="icon icon-download" role="presentation"></span>
						</div>
						<div class="download_btn" onClick="download(current_tab, 'csv')">.CSV (3KB) 
							<span class="icon icon-download" role="presentation"></span>
						</div>
						
						
						<br>
						<br>
					
						</div>
						
						<!-- Table 2 -->
						
						
						<div>
                      <div id="myDiv" class="container2 zigzag">
                       <script>getData("E00116582",'OA','areaname','ageGeog');</script>
						<div id="ageGeog">
						<!-- contents created from getDataTable.js -->
						<br>
						
						
						</div>
						
						</div>	
							
						<div>
							<p class="tablesubtitle">Download full table</p>
							<p class="tablesubsubtitle">Download contents: population by sex; multiple geographies</p>
						</div>
						
							<div class="download_btn" onClick="download(current_tab, 'xlsx')">.XLSX (12KB) 
							<span class="icon icon-download" role="presentation"></span>
						</div>
						<div class="download_btn" onClick="download(current_tab, 'csv')">.CSV (3KB) 
							<span class="icon icon-download" role="presentation"></span>
						</div>
						<br>
						<br>
					
						</div>
						
						
							<!-- Table 3 -->
						
						<div>
                      <div id="myDiv" class="container2 zigzag">
                      <script>getData("E00116582",'OA','areaname','popTime');</script>
						<div id="popTime">
						<!-- contents created from getDataTable.js -->
						<br>
						
						
						</div>
						
						</div>	
							
						<div>
							<p class="tablesubtitle">Download full table</p>
							<p class="tablesubsubtitle">Download contents: population by sex; multiple geographies</p>
						</div>
						
						<div class="download_btn" onClick="download(current_tab, 'xlsx')">.XLSX (12KB) 
							<span class="icon icon-download" role="presentation"></span>
						</div>
						<div class="download_btn" onClick="download(current_tab, 'csv')">.CSV (3KB) 
							<span class="icon icon-download" role="presentation"></span>
						</div>
						<br>
						<br>
					
						</div>
					</div>
			
			
			
		</div>             
	</body>  
</html>  